---
- block:
  - include: fish.yml

  - name: ensure basic packages is installed (in Archlinux)
    pacman:
      name: "{{ item }}"
    with_items:
      - "{{ kse201_base.packages.native.basic }}"
    when: ansible_os_family == "Archlinux"

  - name: ensure basic packages is installed (in RedHat family)
    yum:
      name: "{{ item }}"
    with_items:
      - "{{ kse201_base.packages.native.basic }}"
    when: ansible_os_family == "RedHat"

  - include: proxy.yml

  - name: make freshclam config dir
    file:
      path: /etc/clamav
      state: directory

  - name: deploy freshclam.conf
    template:
      src: ../templates/freshclam.conf.j2
      dest: /etc/clamav/freshclam.conf
      mode: 0700
      owner: root

  - name: ensure additional packages is installed
    pacman:
      name: "{{ item }}"
    with_items:
      - "{{ kse201_base.packages.native.additional }}"
    when: ansible_os_family == "Archlinux"

  - name: ensure docker is installed
    pacman:
      name: docker
    tags:
      - docker
    when: ansible_os_family == "Archlinux"
  become: yes
